{% extends "blog/base.html" %}
  
  {% block title %}{{ post.title }}{% endblock %}
  
  {% block content %}
  <article class="panel detail">
    <h2>{{ post.title }}</h2>
    <div class="meta">By {{ post.author }} — {{ post.created_at }}</div>
    {% if post.image %}
      <div style="margin:10px 0; border-radius:10px; overflow:hidden; border:1px solid var(--border)">
        <img src="{{ post.image.url }}" alt="{{ post.title }}" style="width:100%; height:auto; display:block;"/>
      </div>
    {% endif %}
    <div class="content">{{ post.content|linebreaks }}</div>
    <div class="spacer"></div>
    <button class="btn secondary" data-action="copy-link">Copy link</button>
    <a class="btn" href="/">← Back to posts</a>
  </article>

  <section id="comments" class="panel comments">
    <h3>Comments</h3>
    {% for comment in post.comments.all %}
      <div class="comment">
        <div>
          <strong>{{ comment.author }}</strong>
          <time>{{ comment.created_at }}</time>
        </div>
        <p>{{ comment.content }}</p>
      </div>
    {% empty %}
      <p>No comments yet.</p>
    {% endfor %}

    {% if request.user.is_authenticated %}
      <form method="post" style="margin-top:12px;">
        {% csrf_token %}
        {{ comment_form.non_field_errors }}
        <div>
          {{ comment_form.content.errors }}
          {{ comment_form.content }}
        </div>
        <div class="spacer"></div>
        <button class="btn" type="submit">Add comment</button>
      </form>
    {% else %}
      <p class="post-meta" style="margin-top:10px;">Please <a class="nav-link" href="/admin/login/?next={{ request.path }}">login</a> to comment.</p>
    {% endif %}
  </section>
{% endblock %}
